(window.webpackJsonpcoauthor=window.webpackJsonpcoauthor||[]).push([[0],{380:function(e,t,a){e.exports=a.p+"static/media/signupbg.1cd6d96c.png"},381:function(e,t){e.exports="data:image/png;base64,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"},387:function(e,t,a){e.exports=a(713)},45:function(e,t,a){},713:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),i=a(12),s=a.n(i),o=(a(392),a(382)),l=(a(394),a(384)),c=a(25),u=a(98),h=(a(64),a(23)),p=(a(88),a(30)),m=a(16),d=a(17),y=a(19),f=a(18),b=a(10),E=a(20),g=(a(278),a(99)),v=(a(134),a(51)),k=(a(43),a(13)),O=(a(50),a(4)),S=(a(135),a(82)),C=(a(115),a(47)),j=(a(371),a(132)),w=(a(269),a(128)),x=(a(54),a(15)),L=(a(114),a(34)),R=(a(211),a(76)),P=(a(45),a(32)),A=a(22),U=(a(122),a(66)),I=(a(183),a(38)),N=(a(123),a(53)),M=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(y.a)(this,Object(f.a)(t).call(this,e))).showModal=function(){a.setState({visible:!0})},a.handleCancel=function(e){a.setState({visible:!1})},a.onChange=function(e){a.setState({value:e.target.value})},a.handleReport=function(e){var t=a.state.text,n=a.state.value;null===n?x.a.error("Please select a type"):0===t.length?x.a.error("Please provide reasoning"):(Object(A.getFirestore)().collection("reports").doc().set({postId:a.props.id,type:a.props.type,category:n,reason:t}),a.setState({visible:!1},(function(){"story"===a.type?x.a.success("Story has been reported! We'll be looking into it."):x.a.success("Prompt has been reported! We'll be looking into it.")})))},a.handleTextChange=function(e){a.setState({text:e.target.value})},a.state={visible:!1,value:null,text:""},a.onChange=a.onChange.bind(Object(b.a)(a)),a.handleReport=a.handleReport.bind(Object(b.a)(a)),a.handleTextChange=a.handleTextChange.bind(Object(b.a)(a)),a}return Object(E.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=N.a.TextArea;return r.a.createElement(n.Fragment,null,"card"===this.props.component?r.a.createElement("button",{id:"cardActionBtn",onClick:this.showModal},r.a.createElement(O.a,{type:"warning"})):r.a.createElement(k.a,{type:"link",onClick:this.showModal},r.a.createElement("span",{style:{display:"flex",alignItems:"center"}},r.a.createElement(O.a,{type:"warning"}))),r.a.createElement(U.a,{visible:this.state.visible,onCancel:this.handleCancel,onOk:this.handleReport,okText:"Report"},r.a.createElement(h.a,{style:{padding:"24px"}},r.a.createElement(h.a,{style:{marginBottom:"24px"}},r.a.createElement("h3",null,"Report '",this.props.title,"'")),r.a.createElement(h.a,{style:{marginTop:"24px",marginBottom:"24px"}},r.a.createElement(I.a.Group,{onChange:this.onChange,value:this.state.value},r.a.createElement(I.a,{value:"language"},"Hateful language"),r.a.createElement(I.a,{value:"invalid"},"story"===this.props.type?"Not a story":"Not a prompt"),r.a.createElement(I.a,{value:"other"},"Other"))),r.a.createElement(h.a,null,r.a.createElement(e,{placeholder:"Reason",rows:5,onChange:this.handleTextChange})))))}}]),t}(n.Component),T=a(95),D=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(y.a)(this,Object(f.a)(t).call(this,e))).state={likes:[],amountOfLikes:0,userLiked:!1,photoURL:null},a.like=a.like.bind(Object(b.a)(a)),a.delete=a.delete.bind(Object(b.a)(a)),a.userLiked=a.userLiked.bind(Object(b.a)(a)),a.getAvatar=a.getAvatar.bind(Object(b.a)(a)),a}return Object(E.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.setState({amountOfLikes:this.props.amountOfLikes}),this.userLiked(),this.getAvatar()}},{key:"getTime",value:function(){var e=this.props.time;if(e){var t=48-Math.abs(new Date-e.toDate())/36e5,a=60*t,n="The time remaining for this prompt to get 10 likes!";if(t>1)return r.a.createElement(L.a,{title:n},r.a.createElement(R.a,{style:{background:"none",border:"1px solid rgb(135, 232, 222, 0.5)",color:"#87e8de"}},r.a.createElement(O.a,{style:{marginRight:"4px"},type:"clock-circle"}),Math.round(t)+"h"));if(t>0)return r.a.createElement(L.a,{title:n},r.a.createElement(O.a,{style:{marginRight:"4px"},type:"clock-circle"}),r.a.createElement(R.a,{color:"#cf1322"},60-Math.round(a)+"min"));a<=0&&this.delete()}}},{key:"delete",value:function(){Object(A.getFirestore)().collection("posts").doc(this.props.id).delete();for(var e=0;e<this.props.likes.length;e++)Object(A.getFirestore)().collection("users").doc(this.props.likes[e].displayName).liked.doc(this.props.id).delete()}},{key:"userLiked",value:function(){for(var e=this.props.likes,t=0;t<e.length;t++)e[t]===this.props.auth.displayName?this.setState({userLiked:!0}):this.setState({userLiked:!1})}},{key:"renderHeart",value:function(){return this.state.userLiked?r.a.createElement("span",{className:"heart-filled"},r.a.createElement(O.a,{type:"heart",theme:"filled",size:"large",key:"heart"}),r.a.createElement("span",{id:"likes"},this.state.amountOfLikes)):r.a.createElement("span",{className:"heart"},r.a.createElement(O.a,{type:"heart",key:"heart"}),r.a.createElement("span",{id:"likes"},this.state.amountOfLikes))}},{key:"like",value:function(){!1===this.props.auth.isEmpty?!1===this.state.userLiked?(this.setState({userLiked:!0,amountOfLikes:this.state.amountOfLikes+1}),Object(A.getFirestore)().collection("posts").doc(this.props.id).update({likes:T.firestore.FieldValue.arrayUnion(this.props.auth.displayName),likeCount:T.firestore.FieldValue.increment(1)})):(this.setState({userLiked:!1,amountOfLikes:this.state.amountOfLikes-1}),Object(A.getFirestore)().collection("posts").doc(this.props.id).update({likes:T.firestore.FieldValue.arrayRemove(this.props.auth.displayName),likeCount:T.firestore.FieldValue.increment(-1)})):x.a.warning("Please login or sign up to like prompts")}},{key:"getAvatar",value:function(){var e=this;Object(A.getFirestore)().collection("users").doc(this.props.author).get().then((function(t){t.exists?void 0!==t.data().photoURL?e.setState({photoURL:t.data().photoURL}):e.setState({photoURL:null}):x.a.error("No such document!")})).catch((function(e){x.a.error("Error getting document:",e)}))}},{key:"deletePromptButton",value:function(){return this.props.auth.isEmpty?r.a.createElement(L.a,{title:"Report this prompt"},r.a.createElement(M,{title:this.props.title,type:"prompt",id:this.props.id,component:"card"})):this.props.auth.displayName===this.props.author?r.a.createElement(L.a,{title:"Delete prompt"},r.a.createElement(w.a,{title:"Are you sure delete this prompt?",onConfirm:this.delete,okText:"Yes",cancelText:"No"},r.a.createElement("button",{id:"cardActionBtn"},r.a.createElement(O.a,{type:"delete",key:"delete"})))):r.a.createElement(L.a,{title:"Report this prompt"},r.a.createElement("button",{id:"cardActionBtn"},r.a.createElement(O.a,{type:"warning",key:"warning"})))}},{key:"render",value:function(){var e=j.a.Meta;return r.a.createElement(j.a,{actions:[r.a.createElement("button",{id:"cardActionBtn",onClick:this.like},this.renderHeart()),r.a.createElement(L.a,{title:this.props.author},r.a.createElement("button",{id:"cardActionBtn"},r.a.createElement(c.c,{to:{pathname:"/user/"+this.props.author}},r.a.createElement(O.a,{type:"user",key:"book"})))),this.deletePromptButton()]},r.a.createElement(e,{avatar:r.a.createElement(c.c,{to:{pathname:"/user/"+this.props.author}},r.a.createElement(L.a,{title:this.props.author},null!==this.state.photoURL?r.a.createElement(C.a,{src:this.state.photoURL}):r.a.createElement(C.a,{style:{background:"#111717",color:"#171F22"},icon:"user"}))),title:r.a.createElement("span",{id:"title-container"},r.a.createElement("span",{id:"card-title"},this.props.title),r.a.createElement(R.a,{style:{background:"none",border:"1px solid rgb(135, 232, 222, 0.5)",color:"#87e8de"}},"Prompt"),this.getTime()),description:r.a.createElement("div",null,r.a.createElement("small",null,this.props.genre),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("span",{id:"card-content"},this.props.content),r.a.createElement("br",null))}))}}]),t}(n.Component),F=Object(P.b)((function(e,t){return{posts:e.firestore.ordered.posts,auth:e.firebase.auth}}))(D),B=a(46),W=a(57),H=(a(646),a(378)),z=(a(191),a(49)),V=a(69);a(365);function G(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function X(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?G(a,!0).forEach((function(t){Object(V.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):G(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var K=a(87),q=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(y.a)(this,Object(f.a)(t).call(this,e))).handleChange=function(e){if("content"===e.target.id){var t=e.target.value.toString();a.setState({remainingCharacters:500-t.length})}a.setState(Object(V.a)({},e.target.id,e.target.value))},a.handleSelectChange=function(e){a.setState({genre:e})},a.handleRadioChange=function(e){a.setState({numberOfChapters:e.target.value})},a.handleSubmit=function(e){e.preventDefault(),a.validateForm(a.state)},a.state={title:"",content:"",genre:"",likes:[],visible:!1,remainingCharacters:500,numberOfChapters:null,type:"prompt"},a.handleCancel=a.handleCancel.bind(Object(b.a)(a)),a.showModal=a.showModal.bind(Object(b.a)(a)),a}return Object(E.a)(t,e),Object(d.a)(t,[{key:"showModal",value:function(){this.setState({visible:!0})}},{key:"handleCancel",value:function(){this.setState({visible:!1})}},{key:"validateForm",value:function(e){return e.title.length<4||e.content.length<10?x.a.error("Title or content length is too short"):0===e.genre.length?x.a.error("Please select a category"):null===e.numberOfChapters?x.a.error("Please select amount of chapters"):e.remainingCharacters<0?x.a.error("Content is too long"):(this.props.createPost(e),void this.handleCancel())}},{key:"render",value:function(){var e=N.a.TextArea,t=v.a.Option;return r.a.createElement("div",null,r.a.createElement(k.a,{onClick:this.showModal,type:"primary"},r.a.createElement("div",{style:{display:"flex",alignItems:"center"}},r.a.createElement(K.c,{style:{marginRight:"5px"}}),this.props.title)),r.a.createElement(U.a,{className:"post-modal",visible:this.state.visible,onCancel:this.handleCancel,footer:null},r.a.createElement("div",{className:"post-modal-form",style:{padding:"24px"}},r.a.createElement("h2",null,"New Prompt"),r.a.createElement(z.a,{onSubmit:this.handleSubmit,className:"login-form"},r.a.createElement(z.a.Item,null,r.a.createElement("label",{for:"title"},r.a.createElement("small",null,"Title")),r.a.createElement(N.a,{id:"title",onChange:this.handleChange})),r.a.createElement(z.a.Item,{style:{marginBottom:0}},r.a.createElement("label",{for:"content"},r.a.createElement("small",null,"Content")),r.a.createElement(e,{id:"content",onChange:this.handleChange,rows:5})),r.a.createElement("span",{style:this.state.remainingCharacters<0?{color:"#fa541c",opacity:.5}:{opacity:.5}},r.a.createElement("small",null,this.state.remainingCharacters," characters left")),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(z.a.Item,null,r.a.createElement("small",null,"Number of chapters"),r.a.createElement("br",null),r.a.createElement(I.a.Group,{buttonStyle:"solid",onChange:this.handleRadioChange},r.a.createElement(I.a.Button,{value:2},"2"),r.a.createElement(I.a.Button,{value:3},"3"),r.a.createElement(I.a.Button,{value:4},"4"))),r.a.createElement(z.a.Item,null,r.a.createElement(v.a,{showSearch:!0,style:{width:200},placeholder:"Category",onChange:this.handleSelectChange,optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},r.a.createElement(t,{value:"Comedy"},"Comedy"),r.a.createElement(t,{value:"Horror"},"Horror"),r.a.createElement(t,{value:"Fantasy"},"Fantasy"),r.a.createElement(t,{value:"SciFi"},"Sci-Fi"),r.a.createElement(t,{value:"Other"},"Other"))),r.a.createElement(k.a,{type:"primary",htmlType:"submit"},r.a.createElement(O.a,{type:"plus"}),"Post Prompt")))))}}]),t}(r.a.Component),Y=Object(P.b)((function(e){return{auth:e.firebase.auth}}),(function(e){return{createPost:function(t){return e(function(e){return function(t,a,n){var r=n.getFirebase,i=(0,n.getFirestore)(),s=new Date;i.collection("posts").add(X({},e,{likeCount:0,author:r().auth().currentUser.displayName,authorPic:r().auth().currentUser.photoURL,createdAt:new Date,time:s.getFullYear()+"-"+(s.getMonth()+1)+"-"+s.getDate()+" - "+s.getHours()+":"+s.getMinutes()+":"+s.getSeconds()})).then((function(e){i.collection("posts").doc(e.id).collection("likes").doc(r().auth().currentUser.displayName).set({uid:r().auth().currentUser.uid})})).then((function(){t({type:"CREATE_POST",post:e})})).catch((function(e){t({type:"CREATE_PROJECT_ERROR",err:e})})),x.a.success("Your prompt has been posted!")}}(t))}}}))(q),Z=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(y.a)(this,Object(f.a)(t).call(this,e))).showModal=function(){a.setState({visible:!0})},a.handleClose=function(e){a.setState({visible:!1})},a.state={visible:!1,slide:1},a.showModal=a.showModal.bind(Object(b.a)(a)),a.handleClose=a.handleClose.bind(Object(b.a)(a)),a.next=a.next.bind(Object(b.a)(a)),a.previous=a.previous.bind(Object(b.a)(a)),a.carousel=r.a.createRef(),a}return Object(E.a)(t,e),Object(d.a)(t,[{key:"next",value:function(){this.carousel.next(),this.setState({slide:this.state.slide+1})}},{key:"previous",value:function(){this.carousel.prev(),this.setState({slide:this.state.slide-1})}},{key:"renderButtons",value:function(){return 1===this.state.slide?r.a.createElement(k.a,{onClick:this.next},"Next",r.a.createElement(O.a,{type:"right"})):2===this.state.slide?r.a.createElement(n.Fragment,null,r.a.createElement(k.a,{onClick:this.previous,style:{marginRight:"7px"}},r.a.createElement(O.a,{type:"left"}),"Prev"),r.a.createElement(k.a,{onClick:this.next},"Next",r.a.createElement(O.a,{type:"right"}))):r.a.createElement(k.a,{onClick:this.previous,style:{marginRight:"7px"}},r.a.createElement(O.a,{type:"left"}),"Prev")}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(k.a,{onClick:this.showModal},r.a.createElement(O.a,{type:"question"})),r.a.createElement(U.a,{visible:this.state.visible,onCancel:this.handleClose,footer:null,style:{backgroundColor:"#111717"}},r.a.createElement(H.a,{ref:function(t){return e.carousel=t},dots:!1,className:"help-carousel",effect:"fade"},r.a.createElement("div",null,r.a.createElement("h1",null,"Step 1: Prompts"),r.a.createElement("br",null),r.a.createElement("p",null,"Post and like story ideas (called prompts).",r.a.createElement("br",null),"Prompts that get ",r.a.createElement("bold",null,"15")," likes within 2 days become stories!",r.a.createElement("br",null),"Those that don't get deleted."),r.a.createElement("br",null),r.a.createElement(Y,{title:"New Prompt"})),r.a.createElement("div",null,r.a.createElement("h1",null,"Step 2: Stories"),r.a.createElement("br",null),r.a.createElement("p",null,"Stories are divided into multiple chapters",r.a.createElement("br",null),"Users have 48 hours per chapter to submit their versions!"),r.a.createElement("br",null),r.a.createElement(c.c,{to:{pathname:"/stories/all"}},r.a.createElement(k.a,{type:"primary",onClick:this.handleClose},"All Stories"))),r.a.createElement("div",null,r.a.createElement("h1",null,"Step 3: Done!"),r.a.createElement("p",null,"After all the chapters have been submitted and ranked, the story is complete!"),r.a.createElement("br",null),r.a.createElement(c.c,{to:{pathname:"/stories/complete"}},r.a.createElement(k.a,{type:"primary",onClick:this.handleClose},"Complete stories")))),r.a.createElement("div",{style:{textAlign:"center",paddingBottom:"24px",backgroundColor:"#111717"}},this.renderButtons())))}}]),t}(n.Component),J=function(e){function t(){return Object(m.a)(this,t),Object(y.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(E.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{id:"feed-header-text"},r.a.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",marginBottom:"10px"}},r.a.createElement("h1",{style:{marginRight:"10px",marginBottom:0}},"Prompts"),r.a.createElement(Z,{step:1}))))}}]),t}(n.Component),Q=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(y.a)(this,Object(f.a)(t).call(this,e))).state={sort:"new",loaded:!1},a.handleSort=a.handleSort.bind(Object(b.a)(a)),a.handleSortOrder=a.handleSortOrder.bind(Object(b.a)(a)),a}return Object(E.a)(t,e),Object(d.a)(t,[{key:"handleSort",value:function(e){return this.props.sort(e)}},{key:"componentDidMount",value:function(){this.props.posts||this.setState({loaded:!1})}},{key:"componentDidUpdate",value:function(e,t){e.posts!==this.props.posts&&this.setState({loaded:!0})}},{key:"getPrompts",value:function(){var e=this.props.posts;return this.state.loaded?this.props.posts.length>0?e.map((function(e,t){return r.a.createElement(p.a,{id:"prompt"},r.a.createElement(F,{key:e.id,id:e.id,title:e.title,genre:e.genre,content:e.content,author:e.author,authorPic:e.authorPic?e.authorPic:null,time:e.createdAt,likes:e.likes,amountOfLikes:e.likes.length}))})):r.a.createElement("div",{style:{height:"400px",display:"flex",justifyContent:"center",alignItems:"center"}},r.a.createElement("p",{style:{textAlign:"center"}},"No prompts found :( ",r.a.createElement("br",null),r.a.createElement("br",null),this.props.auth.isEmpty?"":r.a.createElement(Y,{title:"Post your own prompt!"}))):r.a.createElement("div",{style:{display:"flex",marginTop:"100px",justifyContent:"center"}},r.a.createElement(S.a,{size:"large"}))}},{key:"getSortOrder",value:function(){return"desc"===this.props.order?r.a.createElement(k.a,{onClick:this.handleSortOrder},r.a.createElement(O.a,{type:"down"})):r.a.createElement(k.a,{onClick:this.handleSortOrder},r.a.createElement(O.a,{type:"up"}))}},{key:"handleSortOrder",value:function(){return this.props.sortOrder()}},{key:"render",value:function(){var e=v.a.Option;return r.a.createElement("div",null,r.a.createElement(h.a,null,r.a.createElement(J,{loggedIn:!this.props.auth.isEmpty}),r.a.createElement("div",{id:"feed-header"},r.a.createElement("div",{id:"breadcrumb-container"},r.a.createElement(g.a,null,r.a.createElement(g.a.Item,null,"Prompts"),r.a.createElement(g.a.Item,null,this.props.query))),r.a.createElement("div",null,r.a.createElement(v.a,{showArrow:!1,defaultValue:"createdAt",style:{width:100},onChange:this.handleSort},r.a.createElement(e,{value:"createdAt",style:{display:"flex",alignItems:"center"}},r.a.createElement(O.a,{type:"clock-circle",style:{marginRight:"7px"}}),"New"),r.a.createElement(e,{value:"likeCount",style:{display:"flex",alignItems:"center"}},r.a.createElement(O.a,{type:"star",style:{marginRight:"7px"}}),"Top"))),this.getSortOrder()),r.a.createElement("div",null,this.getPrompts())))}}]),t}(n.Component),_=Object(B.d)(Object(P.b)((function(e,t){return{posts:e.firestore.ordered.posts,auth:e.firebase.auth}})),Object(W.firestoreConnect)((function(e){var t=e.getAll,a=e.query,n=e.sortBy,r=e.order;return!0===t?[{collection:"posts",orderBy:[n,r]}]:[{collection:"posts",orderBy:[n,r],where:["genre","==",a]}]})))(Q),$=a(202),ee=a.n($),te=a(95),ae=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(y.a)(this,Object(f.a)(t).call(this,e))).state={likes:[],amountOfLikes:0,userLiked:!1,photoURL:null},a.like=a.like.bind(Object(b.a)(a)),a.userLiked=a.userLiked.bind(Object(b.a)(a)),a.getAvatar=a.getAvatar.bind(Object(b.a)(a)),a}return Object(E.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.setState({amountOfLikes:this.props.likes.length}),this.userLiked(),this.getAvatar()}},{key:"like",value:function(){!1===this.props.auth.isEmpty?!1===this.state.userLiked?(this.setState({userLiked:!0,amountOfLikes:this.state.amountOfLikes+1}),Object(A.getFirestore)().collection("stories").doc(this.props.id).update({likes:te.firestore.FieldValue.arrayUnion(this.props.auth.displayName),likeCount:te.firestore.FieldValue.increment(1)})):(this.setState({userLiked:!1,amountOfLikes:this.state.amountOfLikes-1}),Object(A.getFirestore)().collection("stories").doc(this.props.id).update({likes:te.firestore.FieldValue.arrayRemove(this.props.auth.displayName),likeCount:te.firestore.FieldValue.increment(-1)})):x.a.warning("Please login or sign up to like prompts")}},{key:"userLiked",value:function(){for(var e=this.props.likes,t=0;t<e.length;t++){if(e[t]===this.props.auth.displayName){this.setState({userLiked:!0});break}this.setState({userLiked:!1})}}},{key:"renderHeart",value:function(){return this.state.userLiked?r.a.createElement("span",{className:"heart-filled"},r.a.createElement(O.a,{type:"heart",theme:"filled",size:"large",key:"heart"}),r.a.createElement("span",{id:"likes"},this.state.amountOfLikes)):r.a.createElement("span",{className:"heart"},r.a.createElement(O.a,{type:"heart",key:"heart"}),r.a.createElement("span",{id:"likes"},this.state.amountOfLikes))}},{key:"getAvatar",value:function(){var e=this;Object(A.getFirestore)().collection("users").doc(this.props.author).get().then((function(t){t.exists?void 0!==t.data().photoURL?e.setState({photoURL:t.data().photoURL}):e.setState({photoURL:null}):x.a.error("No such document!")})).catch((function(e){x.a.error("Error getting document:",e)}))}},{key:"getTimeLeft",value:function(){var e,t=this.props.currentChapter,a=this.props.createdAt.toDate(),n=new Date,i=new Date(a.getTime()+1728e5),s=new Date(i.getTime()+1728e5),o=new Date(s.getTime()+1728e5),l=new Date(o.getTime()+1728e5);switch(t){case 1:e=(i-n)/6e4;break;case 2:e=(s-n)/6e4;break;case 3:e=(o-n)/6e4;break;case 4:e=(l-n)/6e4}return e>60?r.a.createElement(L.a,{title:"Hours left until chapter selection"},r.a.createElement(R.a,{style:{background:"none",border:"1px solid rgb(135, 232, 222, 0.5)",color:"#87e8de"}},r.a.createElement("span",{style:{display:"flex",alignItems:"center"}},r.a.createElement(O.a,{style:{marginRight:"4px"},type:"clock-circle"}),Math.round(e/60)+"h "))):e>0?r.a.createElement(L.a,{title:"Minutes left until chapter selection"},r.a.createElement(R.a,{style:{background:"none",border:"1px solid rgb(135, 232, 222, 0.5)",color:"#87e8de"}},r.a.createElement("span",{style:{display:"flex",alignItems:"center"}},r.a.createElement(O.a,{style:{marginRight:"4px"},type:"clock-circle"}),Math.round(e)+" min"))):void 0}},{key:"render",value:function(){var e=j.a.Meta;return r.a.createElement(j.a,{actions:[r.a.createElement(L.a,{title:"Like story"},r.a.createElement("button",{id:"cardActionBtn",onClick:this.like},r.a.createElement("span",{className:"heart-hover"},this.renderHeart()))),r.a.createElement(L.a,{title:"Share story"},r.a.createElement(ee.a,{text:"cowrite.io/story/"+this.props.id,onCopy:function(){return x.a.success("Link copied to clipboard")}},r.a.createElement("button",{id:"cardActionBtn"},r.a.createElement(O.a,{type:"share-alt"})))),r.a.createElement(L.a,{title:this.props.author},r.a.createElement("button",{id:"cardActionBtn"},r.a.createElement(O.a,{type:"user"}))),r.a.createElement(L.a,{title:"Report this prompt"},r.a.createElement(M,{title:this.props.title,type:"story",id:this.props.id,component:"card"}))],hoverable:!0},r.a.createElement(c.b,{to:{pathname:"/story/"+this.props.id,state:{id:this.props.id,auth:this.props.auth,yposition:this.props.yposition,query:this.props.query}}},r.a.createElement(e,{avatar:r.a.createElement(c.c,{to:{pathname:"/user/"+this.props.author}},r.a.createElement(L.a,{title:this.props.author},null!==this.state.photoURL?r.a.createElement(C.a,{src:this.state.photoURL}):r.a.createElement(C.a,{style:{background:"#111717",color:"#171F22"},icon:"user"}))),title:r.a.createElement("span",{id:"title-container"},r.a.createElement("span",{id:"card-title"},this.props.title),r.a.createElement(R.a,{style:{background:"none",border:"1px solid rgb(135, 232, 222, 0.5)",color:"#87e8de"}},this.props.complete?"COMPLETE":this.props.currentChapter!==this.props.numberOfChapters?r.a.createElement(L.a,{title:"Current chapter"},r.a.createElement("span",{style:{display:"flex",alignItems:"center"}},r.a.createElement(O.a,{type:"book",style:{marginRight:"4px"}}),this.props.currentChapter+"/"+this.props.numberOfChapters)):"FINAL CHAPTER"),this.getTimeLeft()),description:r.a.createElement("div",null,r.a.createElement("small",null,this.props.genre),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("span",{id:"card-content"},this.props.content),r.a.createElement("br",null))})))}}]),t}(n.Component),ne=function(e){function t(){return Object(m.a)(this,t),Object(y.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(E.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{id:"feed-header-text"},r.a.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",marginBottom:"10px"}},r.a.createElement("h1",{style:{marginRight:"10px",marginBottom:0}},"Stories"),r.a.createElement(Z,{step:2}))))}}]),t}(n.Component),re=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(y.a)(this,Object(f.a)(t).call(this,e))).listenToScroll=function(){a.setState({yposition:window.scrollY})},a.state={sort:"new",loaded:!1,yposition:0,sortOrder:"desc"},a.handleSort=a.handleSort.bind(Object(b.a)(a)),a.handleSortOrder=a.handleSortOrder.bind(Object(b.a)(a)),a}return Object(E.a)(t,e),Object(d.a)(t,[{key:"handleSort",value:function(e){return this.props.sort(e)}},{key:"componentDidMount",value:function(){this.props.stories||this.setState({loaded:!1}),window.addEventListener("scroll",this.listenToScroll)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("scroll",this.listenToScroll)}},{key:"componentDidUpdate",value:function(e,t){var a=this;e.stories!==this.props.stories&&(0===this.state.yposition?this.setState({loaded:!0,yposition:this.props.yposition},(function(){a.scrollTo(a.state.yposition)})):this.setState({loaded:!0},(function(){a.listenToScroll(),a.scrollTo(a.state.yposition)})))}},{key:"scrollTo",value:function(e){window.scrollTo({top:e,behavior:"smooth"})}},{key:"getStories",value:function(){var e=this,t=this.props.stories;return this.state.loaded?this.props.stories.length>0?t.map((function(t,a){return r.a.createElement(p.a,{id:"prompt"},r.a.createElement(ae,{key:t.id,auth:e.props.auth,id:t.id,title:t.title,genre:t.genre,content:t.prompt,numberOfChapters:t.numberOfChapters,author:t.author,authorPic:t.authorPic?t.authorPic:null,createdAt:t.createdAt,currentChapter:t.currentChapter,chapters:t.chapters,chapter1:t.chapter1,chapter2:t.chapter2,chapter3:t.chapter3,chapter4:t.chapter4,likes:t.likes,yposition:e.state.yposition,query:e.props.query,complete:t.complete}))})):r.a.createElement("div",{style:{height:"400px",display:"flex",justifyContent:"center",alignItems:"center"}},r.a.createElement("p",{style:{textAlign:"center"}},"No stories found :( ",r.a.createElement("br",null),"Like prompts to help convert them into stories!")):r.a.createElement("div",{style:{display:"flex",marginTop:"25%",justifyContent:"center"}},r.a.createElement(S.a,{size:"large"}))}},{key:"getSortOrder",value:function(){return"desc"===this.props.order?r.a.createElement(k.a,{onClick:this.handleSortOrder},r.a.createElement(O.a,{type:"down"})):r.a.createElement(k.a,{onClick:this.handleSortOrder},r.a.createElement(O.a,{type:"up"}))}},{key:"handleSortOrder",value:function(){return this.props.sortOrder()}},{key:"render",value:function(){var e=v.a.Option;return r.a.createElement("div",null,r.a.createElement(ne,null),r.a.createElement(h.a,null,r.a.createElement("div",{id:"feed-header"},r.a.createElement("div",{id:"breadcrumb-container"},r.a.createElement(g.a,null,r.a.createElement(g.a.Item,null,"Stories"),r.a.createElement(g.a.Item,null,this.props.query))),r.a.createElement("div",null,r.a.createElement(v.a,{showArrow:!1,defaultValue:"createdAt",style:{width:120},onChange:this.handleSort},r.a.createElement(e,{value:"createdAt",style:{display:"flex",alignItems:"center"}},r.a.createElement(O.a,{type:"clock-circle",style:{marginRight:"7px"}}),"New"),r.a.createElement(e,{value:"likeCount",style:{display:"flex",alignItems:"center"}},r.a.createElement(O.a,{type:"star",style:{marginRight:"7px"}}),"Top"),r.a.createElement(e,{value:"numberOfChapters",style:{display:"flex",alignItems:"center"}},r.a.createElement(O.a,{type:"read",style:{marginRight:"7px"}}),"Chapters")),this.getSortOrder())),this.getStories()))}}]),t}(n.Component),ie=Object(B.d)(Object(P.b)((function(e,t){return{stories:e.firestore.ordered.stories,auth:e.firebase.auth}})),Object(W.firestoreConnect)((function(e){var t=e.getAll,a=e.sortBy,n=e.query,r=e.order;return!0===t?[{collection:"stories",orderBy:[a,r]}]:"complete"===n?[{collection:"stories",orderBy:[a,r],where:["complete","==",!0]}]:[{collection:"stories",orderBy:[a,r],where:["genre","==",n]}]})))(re),se=(a(368),a(203)),oe=(a(161),a(36)),le=a(157),ce=a(155),ue=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(y.a)(this,Object(f.a)(t).call(this,e))).state={mobile:null},a.updateWidth=a.updateWidth.bind(Object(b.a)(a)),a.getWidth=a.getWidth.bind(Object(b.a)(a)),a}return Object(E.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.getWidth(),window.addEventListener("resize",this.updateWidth)}},{key:"componentDidUpdate",value:function(e,t){t.mobile!==this.state.mobile&&this.renderMenu()}},{key:"getWidth",value:function(){window.innerWidth>768?this.setState({mobile:!1}):this.setState({mobile:!0})}},{key:"updateWidth",value:function(){var e=this,t=this.state.mobile;window.innerWidth>768&&t?this.setState({mobile:!1}):window.innerWidth<768&&!t&&this.setState({mobile:null},(function(){e.setState({mobile:!0})}))}},{key:"renderMenu",value:function(){var e=oe.a.SubMenu;if(null!==this.state.mobile){var t=this.state.mobile;return r.a.createElement(oe.a,Object.assign({onClick:this.handleClick,style:!1===this.state.mobile?{height:"100vh",position:"fixed",overflowY:"scroll",overflowX:"hidden",paddingTop:"100px",top:0,left:0}:{position:"fixed",marginTop:"24px",left:"0",zIndex:100},selectedKeys:window.location.pathname},t?null:{defaultOpenKeys:["sub1","sub2"]},t?null:{openKeys:["sub1","sub2"]},{mode:t?"horizontal":"inline",id:"sidebar"}),r.a.createElement(e,{key:"sub1",title:r.a.createElement("span",null,r.a.createElement(O.a,{type:"edit"}),r.a.createElement("span",null,"Prompts")),style:t?{width:"50%",textAlign:"center"}:null},r.a.createElement(oe.a.Item,{key:"/prompts/all"},r.a.createElement(c.c,{to:{pathname:"/prompts/all"}},r.a.createElement(K.b,{style:he.IconStyle}),"All")),r.a.createElement(oe.a.Item,{key:"/prompts/comedy"},r.a.createElement(c.c,{to:{pathname:"/prompts/comedy",state:{query:"Comedy"}}},r.a.createElement(K.a,{style:he.IconStyle}),"Comedy")),r.a.createElement(oe.a.Item,{key:"/prompts/horror"},r.a.createElement(c.c,{to:{pathname:"/prompts/horror",state:{query:"Horror"}}},r.a.createElement(le.a,{style:he.IconStyle}),"Horror")),r.a.createElement(oe.a.Item,{key:"/prompts/fantasy"},r.a.createElement(c.c,{to:{pathname:"/prompts/fantasy",state:{query:"Fantasy"}}},r.a.createElement(le.b,{style:he.IconStyle}),"Fantasy")),r.a.createElement(oe.a.Item,{key:"/prompts/scifi"},r.a.createElement(c.c,{to:{pathname:"/prompts/scifi",state:{query:"SciFi"}}},r.a.createElement(K.d,{style:he.IconStyle}),"SciFi")),r.a.createElement(oe.a.Item,{key:"/prompts/other"},r.a.createElement(c.c,{to:{pathname:"/prompts/other",state:{query:"Other"}}},r.a.createElement(ce.b,{style:he.IconStyle}),"Other"))),!0===this.state.mobile?"":r.a.createElement(se.a,null),r.a.createElement(e,{key:"sub2",title:r.a.createElement("span",null,r.a.createElement(O.a,{type:"read"}),r.a.createElement("span",null,"Stories")),style:this.state.mobile?{width:"50%",textAlign:"center"}:null},r.a.createElement(oe.a.Item,{key:"/stories/all"},r.a.createElement(c.c,{to:{pathname:"/stories/all",state:{query:"all"}}},r.a.createElement(K.b,{style:he.IconStyle}),"All")),r.a.createElement(oe.a.Item,{key:"/stories/complete"},r.a.createElement(c.c,{to:{pathname:"/stories/complete",state:{query:"complete"}}},r.a.createElement(O.a,{type:"check-circle",style:he.IconStyle}),"Complete")),r.a.createElement(oe.a.Item,{key:"/stories/comedy"},r.a.createElement(c.c,{to:{pathname:"/stories/comedy",state:{query:"Comedy"}}},r.a.createElement(K.a,{style:he.IconStyle}),"Comedy")),r.a.createElement(oe.a.Item,{key:"/stories/horror"},r.a.createElement(c.c,{to:{pathname:"/stories/horror",state:{query:"Horror"}}},r.a.createElement(le.a,{style:he.IconStyle}),"Horror")),r.a.createElement(oe.a.Item,{key:"/stories/fantasy"},r.a.createElement(c.c,{to:{pathname:"/stories/fantasy",state:{query:"Fantasy"}}},r.a.createElement(le.b,{style:he.IconStyle}),"Fantasy")),r.a.createElement(oe.a.Item,{key:"/stories/scifi"},r.a.createElement(c.c,{to:{pathname:"/stories/scifi",state:{query:"SciFi"}}},r.a.createElement(K.d,{style:he.IconStyle}),"SciFi")),r.a.createElement(oe.a.Item,{key:"/stories/other"},r.a.createElement(c.c,{to:{pathname:"/stories/other",state:{query:"Other"}}},r.a.createElement(ce.b,{style:he.IconStyle}),"Other"))))}return r.a.createElement("div",null)}},{key:"render",value:function(){return this.renderMenu()}}]),t}(n.Component),he={IconStyle:{marginRight:"20px",fontSize:"1.2em"}},pe=ue,me=a(276),de=a.n(me),ye=a(379),fe=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(y.a)(this,Object(f.a)(t).call(this,e))).state={loaded:!1},a}return Object(E.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.props.posts||this.setState({loaded:!1})}},{key:"componentDidUpdate",value:function(e,t){e.posts!==this.props.posts&&this.setState({loaded:!0})}},{key:"getPosts",value:function(){var e=this,t=this.props.posts;return this.state.loaded?this.props.posts.length>0?t.map((function(t,a){return r.a.createElement(p.a,{id:"prompt"},"story"===t.type?r.a.createElement(ae,{auth:e.props.auth,key:t.id,id:t.id,createdAt:t.createdAt,title:t.title,genre:t.genre,content:t.prompt,author:t.author,authorPic:t.authorPic?t.authorPic:null,time:t.createdAt,likes:t.likes,amountOfLikes:t.likes.length,currentChapter:t.currentChapter,numberOfChapters:t.numberOfChapters}):r.a.createElement(F,{key:t.id,id:t.id,title:t.title,genre:t.genre,content:t.content,author:t.author,authorPic:t.authorPic?t.authorPic:null,time:t.createdAt,likes:t.likes,amountOfLikes:t.likes.length}))})):r.a.createElement("small",null,"Nothing found"):r.a.createElement("div",{style:{display:"flex",marginTop:"100px",justifyContent:"center"}},r.a.createElement(S.a,{size:"large"}))}},{key:"render",value:function(){return r.a.createElement(h.a,null,this.getPosts())}}]),t}(n.Component),be=Object(B.d)(Object(P.b)((function(e,t){return{posts:e.firestore.ordered.posts,auth:e.firebase.auth}})),Object(W.firestoreConnect)((function(e){var t=e.displayName,a=e.type;return"yourPrompts"===a?[{collection:"posts",where:["author","==",t],storeAs:"posts"}]:"yourStories"===a?[{collection:"stories",where:["author","==",t],storeAs:"posts"}]:"likedPrompts"===a?[{collection:"posts",where:["likes","array-contains",t],storeAs:"posts"}]:"likedStories"===a?[{collection:"stories",where:["likes","array-contains",t],storeAs:"posts"}]:void 0})))(fe),Ee=a(95),ge=function(e){function t(){var e,a;Object(m.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(y.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).fileSelectedHandler=function(e){a.fileUploadHandler(e.target.files[0])},a.fileUploadHandler=function(e){var t=Ee.auth().currentUser,a=t.displayName,n=Ee.storage().ref(a+"/profilePicture/"+e).put(e);n.on("state_changed",(function(e){switch(e.state){case Ee.storage.TaskState.PAUSED:case Ee.storage.TaskState.RUNNING:break;default:console.log(".")}}),(function(e){x.a.error("Upload error: ",e)}),(function(){n.snapshot.ref.getDownloadURL().then((function(e){t.updateProfile({photoURL:e}).then((function(){x.a.success("Display Pic Successfully Changed!"),Object(A.getFirestore)().collection("users").doc(a).update({photoURL:e}).then((function(){window.location.reload()}))})).catch((function(e){x.a.error("Error: ",e)}))}))}))},a}return Object(E.a)(t,e),Object(d.a)(t,[{key:"deleteProfile",value:function(){}},{key:"render",value:function(){return r.a.createElement(h.a,null,r.a.createElement(k.a,{style:{padding:0,margin:0}},r.a.createElement("label",{style:{width:"100%",height:"100%",padding:"10px"},for:"upload"},"Change DP")),r.a.createElement(N.a,{type:"file",id:"upload",style:{visibility:"hidden",width:0,padding:0},onChange:this.fileSelectedHandler}))}}]),t}(n.Component),ve=a(95),ke=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(y.a)(this,Object(f.a)(t).call(this,e))).state={selected:"yourPrompts",isOwnProfile:!1,displayName:"",photoURL:null,userExists:null},a.handleRadioChange=a.handleRadioChange.bind(Object(b.a)(a)),a.deleteProfile=a.deleteProfile.bind(Object(b.a)(a)),a.doesUserExist=a.doesUserExist.bind(Object(b.a)(a)),a}return Object(E.a)(t,e),Object(d.a)(t,[{key:"componentWillMount",value:function(){this.isOwnProfile(),this.doesUserExist()}},{key:"componentDidUpdate",value:function(e){this.props.location.pathname!==e.location.pathname&&(this.isOwnProfile(),this.doesUserExist())}},{key:"isOwnProfile",value:function(){var e=window.location.pathname.split("/")[2];e===this.props.auth.displayName?(this.setState({isOwnProfile:!0,displayName:e}),this.getAvatar(e)):(this.setState({isOwnProfile:!1,displayName:e}),this.getAvatar(e))}},{key:"handleRadioChange",value:function(e){this.setState({selected:e.target.value})}},{key:"showRelevantFeed",value:function(){var e=window.location.pathname.split("/")[2];return r.a.createElement(be,{type:this.state.selected,displayName:e})}},{key:"doesUserExist",value:function(){var e=Object(ye.a)(de.a.mark((function e(){var t,a,n,r;return de.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.location.pathname.split("/"),a=t[2],n=[],e.next=5,ve.firestore().collection("users").get().then((function(e){e.docs.forEach((function(e){n.push(e.data())}))}));case 5:for(r=0;r<n.length;r++)a===n[r].displayName?this.setState({userExists:!0}):this.setState({userExists:!1});case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getAvatar",value:function(e){var t=this;Object(A.getFirestore)().collection("users").doc(e).get().then((function(e){e.exists&&(void 0!==e.data().photoURL?t.setState({photoURL:e.data().photoURL}):t.setState({photoURL:null}))})).catch((function(e){x.a.error("Error getting document:",e)}))}},{key:"deleteProfile",value:function(){var e=ve.auth().currentUser;e.delete().then((function(){Object(A.getFirestore)().collection("users").doc(e.displayName).delete().then((function(){x.a.success("Succesfully deleted profile"),window.location.reload()})).catch((function(e){x.a.error(e)}))})).catch((function(e){x.a.error(e.message)}))}},{key:"renderProfile",value:function(){var e=window.location.pathname.split("/")[2];return this.state.userExists?r.a.createElement("div",null,r.a.createElement(h.a,{style:{marginTop:"48px"}},r.a.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",marginBottom:"24px"}},null!==this.state.photoURL?r.a.createElement(C.a,{shape:"square",size:98,src:this.state.photoURL}):r.a.createElement(C.a,{shape:"square",size:98,style:{background:"#111717",color:"#171F22"},icon:"user"}),r.a.createElement("h1",{style:{marginLeft:"24px"}},e)),this.state.isOwnProfile?r.a.createElement("div",{style:{display:"flex",flexDirection:"row"}},r.a.createElement(ge,{auth:this.props.auth}),r.a.createElement(w.a,{title:"Are you sure you want to delete your profile? (this cannot be undone)",onConfirm:this.deleteProfile,okText:"Yes",cancelText:"No"},r.a.createElement(k.a,null,"Delete"))):null),r.a.createElement(h.a,{style:{marginTop:"48px"},onChange:this.handleRadioChange},r.a.createElement(I.a.Group,{defaultValue:"yourPrompts",buttonStyle:"solid"},this.state.isOwnProfile?r.a.createElement("span",null,r.a.createElement(I.a.Button,{value:"yourPrompts"},"Your Prompts"),r.a.createElement(I.a.Button,{value:"yourStories"},"Your Stories"),r.a.createElement(I.a.Button,{value:"likedPrompts"},"Liked Prompts"),r.a.createElement(I.a.Button,{value:"likedStories"},"Liked Stories")):r.a.createElement("span",null,r.a.createElement(I.a.Button,{value:"yourPrompts"},e,"'s Prompts"),r.a.createElement(I.a.Button,{value:"yourStories"},e,"'s Stories")))),r.a.createElement(h.a,{style:{marginTop:"48px"}},this.showRelevantFeed())):null===this.state.userExists?r.a.createElement("div",{style:{width:"100%",height:"90vh",display:"flex",alignItems:"center",justifyContent:"center"}},r.a.createElement(S.a,null)):r.a.createElement("h2",{style:{marginTop:"100px "}},e+" cannot be found.")}},{key:"render",value:function(){return r.a.createElement("div",null,this.renderProfile())}}]),t}(n.Component),Oe=Object(u.f)((function(e){return r.a.createElement(ke,e)})),Se=function(e){function t(){return Object(m.a)(this,t),Object(y.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(E.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{id:"footer"},"cowrite 2019")}}]),t}(n.Component),Ce=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(y.a)(this,Object(f.a)(t).call(this,e))).state={query:"",getAll:!1,sort:"createdAt",sortOrder:"desc",yposition:0},a.sort=a.sort.bind(Object(b.a)(a)),a.sortOrder=a.sortOrder.bind(Object(b.a)(a)),a}return Object(E.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.getQuery(),this.getScrollPosition(),this.getAll()}},{key:"getQuery",value:function(){this.props.location.state&&this.setState({query:this.props.location.state.query})}},{key:"getScrollPosition",value:function(){this.props.location.state&&this.props.location.state.hasOwnProperty("yposition")&&this.setState({yposition:this.props.location.state.yposition})}},{key:"getAll",value:function(){"all"===window.location.pathname.substr(-3)&&this.setState({getAll:!0})}},{key:"sort",value:function(e){this.setState({sort:e})}},{key:"sortOrder",value:function(){"desc"===this.state.sortOrder?this.setState({sortOrder:"asc"}):this.setState({sortOrder:"desc"})}},{key:"showRelevantFeed",value:function(){return"prompts"===window.location.pathname.slice(1,8)?r.a.createElement(_,{sort:this.sort,order:this.state.sortOrder,sortOrder:this.sortOrder,sortBy:this.state.sort,getAll:this.state.getAll,query:this.state.query}):"user"===window.location.pathname.slice(1,5)?r.a.createElement(Oe,{auth:this.props.auth,isOwnProfile:!0}):r.a.createElement(ie,{sort:this.sort,order:this.state.sortOrder,sortOrder:this.sortOrder,sortBy:this.state.sort,getAll:this.state.getAll,query:this.state.query,yposition:this.state.yposition})}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{id:"home"},r.a.createElement(h.a,null,r.a.createElement(p.a,{xs:24,md:5,xl:3},r.a.createElement(pe,{auth:this.props.auth,query:this.updateQuery})),r.a.createElement(p.a,{xs:22,md:17,xl:19,offset:1,id:"feed-container"},this.showRelevantFeed()))),r.a.createElement(Se,null))}}]),t}(n.Component),je=Object(P.b)((function(e){return{auth:e.firebase.auth}}))(Ce),we=(a(210),a(205)),xe=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(y.a)(this,Object(f.a)(t).call(this,e))).state={photoURL:null},a.getAvatar=a.getAvatar.bind(Object(b.a)(a)),a}return Object(E.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.getAvatar()}},{key:"componentDidUpdate",value:function(e,t){e.displayName!==this.props.displayName&&window.location.reload()}},{key:"getAvatar",value:function(){var e=this;null!==this.props.auth.displayName&&Object(A.getFirestore)().collection("users").doc(this.props.auth.displayName).get().then((function(t){t.exists?void 0!==t.data().photoURL?e.setState({photoURL:t.data().photoURL}):e.setState({photoURL:null}):x.a.error("Pic does not exist")})).catch((function(e){x.a.error(e)}))}},{key:"render",value:function(){var e=r.a.createElement(oe.a,null,r.a.createElement(oe.a.Item,null,r.a.createElement(c.c,{to:{pathname:"/user/"+this.props.auth.displayName}},r.a.createElement(O.a,{type:"user",style:{marginRight:"7px"}}),"Profile")),r.a.createElement(oe.a.Item,{onClick:this.props.signOut,style:{display:"flex",alignItems:"center"}},r.a.createElement(ce.a,{style:{marginRight:"7px"}}),"Logout"));return r.a.createElement("div",null,r.a.createElement(we.a,{overlay:e,trigger:["click"]},r.a.createElement(k.a,{type:"dashed",style:{background:"none"}},null!==this.state.photoURL?r.a.createElement(C.a,{size:"small",style:{marginRight:"10px"},src:this.state.photoURL}):r.a.createElement(C.a,{size:"small",style:{background:"#111717",color:"#171F22",marginRight:"14px"},icon:"user"}),this.props.auth.displayName,r.a.createElement(O.a,{type:"down"}))))}}]),t}(n.Component),Le=(a(706),a(385)),Re=(a(370),a(133)),Pe=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(y.a)(this,Object(f.a)(t).call(this,e))).toggleMenu=function(){a.setState({visible:!a.state.visible})},a.closeMenu=function(){a.setState({visible:!1})},a.state={loaded:!1,newNotifs:0,visible:!1},a.resetNotifs=a.resetNotifs.bind(Object(b.a)(a)),window.addEventListener("scroll",a.closeMenu),a}return Object(E.a)(t,e),Object(d.a)(t,[{key:"componentDidUpdate",value:function(e,t){e.notifications!==this.props.notifications&&(0!==e.notifications&&this.props.notifications>e.notifications?this.setState({loaded:!0,newNotifs:this.props.notifications.length-e.notifications.length+this.state.newNotifs}):this.setState({loaded:!0}))}},{key:"getIcon",value:function(e){var t=this.props.notifications[e].type;return"conversion"===t?r.a.createElement(O.a,{type:"sync"}):"chapter"===t?r.a.createElement(O.a,{type:"forward"}):r.a.createElement(O.a,{type:"check"})}},{key:"getNotifications",value:function(){var e=this.state.loaded,t=this.props.notifications,a=[];if(e){for(var n=0;n<t.length;n++)a.push(r.a.createElement("div",null,r.a.createElement(c.b,{to:{pathname:"/story/"+t[n].id,state:{id:t[n].id,auth:this.props.auth,yposition:0,query:"all"}}},r.a.createElement(Re.a.Item,{key:n,onClick:this.closeMenu,style:{minHeight:"75px",minWidth:"250px",display:"flex",justifyContent:"center",flexDirection:"row"},className:"notification"},r.a.createElement("div",{style:{width:"20%",display:"flex",justifyContent:"center",alignItems:"center"}},this.getIcon(n)),r.a.createElement("div",{style:{width:"75%",display:"flex",justifyContent:"center",flexDirection:"column"}},r.a.createElement("b",null,t[n].title),r.a.createElement("small",{style:{opacity:.6}},t[n].notification," - ",this.getTime(new Date,t[n].date.toDate())))))));return r.a.createElement(Re.a,{style:{maxHeight:"80vh",overflowY:"scroll",overflowX:"hidden"}},a)}return r.a.createElement("small",null,"Loading...")}},{key:"getTime",value:function(e,t){var a=(e-t)/6e4;return a>60?Math.round(a/60)+"h ago":a>1?Math.round(a)+" min ago":"now"}},{key:"resetNotifs",value:function(){this.setState({newNotifs:0})}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(we.a,{overlay:this.getNotifications(),trigger:["click"],onVisibleChange:this.toggleMenu,visible:this.state.visible},r.a.createElement(Le.a,{id:"notification-badge",count:this.state.newNotifs>10?"10+":this.state.newNotifs,onClick:this.resetNotifs},r.a.createElement(O.a,{type:"notification"}))))}}]),t}(n.Component),Ae=Object(B.d)(Object(P.b)((function(e,t){return{notifications:e.firestore.ordered.notifications}})),Object(W.firestoreConnect)((function(e){return[{collection:"notifications",limit:20,orderBy:["date","desc"]}]})))(Pe),Ue=function(e){function t(){return Object(m.a)(this,t),Object(y.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(E.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement(n.Fragment,null,r.a.createElement("div",{className:"nav-link"},r.a.createElement(Y,{title:"Prompt"})),r.a.createElement("div",{className:"nav-link"},r.a.createElement(Z,null)),r.a.createElement("div",{className:"nav-link"},r.a.createElement(xe,{signOut:this.props.signOut,auth:this.props.auth})),r.a.createElement("div",{className:"nav-link"},r.a.createElement(Ae,null)))}}]),t}(n.Component),Ie=Object(P.b)(null,(function(e){return{signOut:function(){return e((function(e,t,a){(0,a.getFirebase)().auth().signOut().then((function(){e({type:"SIGNOUT_SUCCESS"}),x.a.success("Signed out successfully"),window.location.reload()}))}))}}}))(Ue),Ne=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(y.a)(this,Object(f.a)(t).call(this))).handleChange=function(t){e.setState(Object(V.a)({},t.target.id,t.target.value))},e.handleSubmit=function(t){t.preventDefault(),e.props.signIn(e.state)},e.state={email:"",password:"",error:null},e}return Object(E.a)(t,e),Object(d.a)(t,[{key:"componentDidUpdate",value:function(e,t){e.authError!==this.props.authError&&this.setState({error:this.props.authError}),t.error!==this.state.error&&null!==this.state.error&&(x.a.error(this.state.error),this.setState({error:null}))}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(z.a,{onSubmit:this.handleSubmit,className:"login-form"},r.a.createElement("h2",null,"Login"),r.a.createElement("br",null),r.a.createElement(z.a.Item,null,r.a.createElement(N.a,{id:"email",onChange:this.handleChange,prefix:r.a.createElement(O.a,{type:"user",style:{color:"rgba(255,255,255,.25)"}}),placeholder:"Username"})),r.a.createElement(z.a.Item,null,r.a.createElement(N.a.Password,{id:"password",onChange:this.handleChange,prefix:r.a.createElement(O.a,{type:"lock",style:{color:"rgba(255,255,255,.25)"}}),type:"password",placeholder:"Password"})),r.a.createElement(k.a,{type:"primary",htmlType:"submit"},r.a.createElement(O.a,{type:"plus"}),"Login")))}}]),t}(n.Component),Me=Object(P.b)((function(e){return{authError:e.auth.authError}}),(function(e){return{signIn:function(t){return e((a=t,function(e,t,n){(0,n.getFirebase)().auth().signInWithEmailAndPassword(a.email,a.password).then((function(){e({type:"LOGIN_SUCCESS"}),x.a.success("Logged in successfully"),window.location.reload()})).catch((function(t){e({type:"LOGIN_ERROR",err:t})}))}));var a}}}))(Ne),Te=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(y.a)(this,Object(f.a)(t).call(this,e))).state={visible:!1},a.showModal=a.showModal.bind(Object(b.a)(a)),a.handleCancel=a.handleCancel.bind(Object(b.a)(a)),a}return Object(E.a)(t,e),Object(d.a)(t,[{key:"showModal",value:function(){this.setState({visible:!0})}},{key:"handleCancel",value:function(){this.setState({visible:!1})}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(k.a,{onClick:this.showModal},r.a.createElement(O.a,{type:"user"}),"Login"),r.a.createElement(U.a,{visible:this.state.visible,onCancel:this.handleCancel,footer:null,className:"login-form-modal"},r.a.createElement(Me,null)))}}]),t}(r.a.Component),De=a(380),Fe=a.n(De),Be=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(y.a)(this,Object(f.a)(t).call(this))).handleChange=function(t){e.setState(Object(V.a)({},t.target.id,t.target.value))},e.handleSubmit=function(t){t.preventDefault();var a=e.state.email,n=e.state.password,r=e.state.username;0===a.length||0===n.length||0===r.length?x.a.error("Some fields left empty"):r.length>=20?x.a.error("Username too long"):e.props.signUp(e.state)},e.state={email:"",password:"",username:""},e}return Object(E.a)(t,e),Object(d.a)(t,[{key:"componentDidUpdate",value:function(e,t){e.authError!==this.props.authError&&(this.forceUpdate(),x.a.error(this.props.authError))}},{key:"render",value:function(){return r.a.createElement(h.a,{style:{backgroundColor:"#1a1a1a",height:"100%"}},r.a.createElement(p.a,{xs:24,md:12,className:"left-side-signup"},r.a.createElement("h1",null,"Welcome to cowrite!"),r.a.createElement("br",null),r.a.createElement("div",{className:"signup-form"},r.a.createElement(z.a,{onSubmit:this.handleSubmit},r.a.createElement(z.a.Item,null,r.a.createElement(N.a,{id:"username",prefix:r.a.createElement(O.a,{type:"user",style:{color:"rgba(255,255,255,.25)"}}),onChange:this.handleChange,placeholder:"Username"})),r.a.createElement(z.a.Item,null,r.a.createElement(N.a,{id:"email",prefix:r.a.createElement(O.a,{type:"mail",style:{color:"rgba(255,255,255,.25)"}}),onChange:this.handleChange,placeholder:"Email"})),r.a.createElement(z.a.Item,null,r.a.createElement(N.a.Password,{id:"password",prefix:r.a.createElement(O.a,{type:"lock",style:{color:"rgba(255,255,255,.25)"}}),onChange:this.handleChange,placeholder:"Password"})),r.a.createElement(k.a,{type:"primary",htmlType:"submit",className:"sign-up-submit"},"Join")))),r.a.createElement(p.a,{xs:0,md:12},r.a.createElement("div",{className:"join-bg"},r.a.createElement("img",{src:Fe.a,alt:"bg"}))))}}]),t}(n.Component),We=Object(P.b)((function(e){return{authError:e.auth.authError}}),(function(e){return{signUp:function(t){return e((a=t,function(e,t,n){var r=(0,n.getFirebase)(),i=Object(A.getFirestore)(),s=!1;i.collection("users").get().then((function(t){t.forEach((function(e){e.id===a.username&&(s=!0)})),!1===s?r.auth().createUserWithEmailAndPassword(a.email,a.password).then((function(e){return i.collection("users").doc(a.username).set({uid:e.user.uid,displayName:a.username}),r.auth().currentUser.updateProfile({displayName:a.username})})).then((function(){e({type:"SIGNUP_SUCCESS"}),window.location.reload()})).catch((function(t){e({type:"SIGNUP_ERROR",err:t})})):e({type:"NAME_TAKEN"})}))}));var a}}}))(Be),He=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(y.a)(this,Object(f.a)(t).call(this,e))).state={visible:!1},a.handleCancel=a.handleCancel.bind(Object(b.a)(a)),a.showModal=a.showModal.bind(Object(b.a)(a)),a}return Object(E.a)(t,e),Object(d.a)(t,[{key:"showModal",value:function(){this.setState({visible:!0})}},{key:"handleCancel",value:function(){this.setState({visible:!1})}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(k.a,{onClick:this.showModal,type:"primary"},r.a.createElement(O.a,{type:"user"}),"Join"),r.a.createElement(U.a,{visible:this.state.visible,onCancel:this.handleCancel,footer:null,className:"sign-up-modal"},r.a.createElement(We,null)))}}]),t}(r.a.Component),ze=function(e){function t(){return Object(m.a)(this,t),Object(y.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(E.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement(n.Fragment,null,r.a.createElement("div",{className:"nav-link"},r.a.createElement(Z,null)),r.a.createElement("div",{className:"nav-link"},r.a.createElement(Te,null)),r.a.createElement("div",{className:"nav-link"},r.a.createElement(He,null)))}}]),t}(n.Component),Ve=a(381),Ge=a.n(Ve),Xe=Object(P.b)((function(e){return{auth:e.firebase.auth}}))((function(e){var t=e.auth,a=t.uid?r.a.createElement(Ie,{auth:t}):r.a.createElement(ze,null);return r.a.createElement("div",null,r.a.createElement(oe.a,{id:"navBar",mode:"horizontal"},r.a.createElement(h.a,{className:"nav-row"},r.a.createElement(c.c,{to:{pathname:"/"}},r.a.createElement(p.a,{xs:24,md:3,className:"nav-col-left"},r.a.createElement(oe.a.Item,{key:"app"},r.a.createElement("img",{id:"logo",src:Ge.a,alt:"logo"})))),r.a.createElement(p.a,{xs:24,md:20,className:"nav-col-right"},a))))})),Ke=(a(369),a(204)),qe=a(95),Ye=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(y.a)(this,Object(f.a)(t).call(this,e))).state={amountOfLikes:0,userLiked:!1,expanded:!1},a.like=a.like.bind(Object(b.a)(a)),a.userLiked=a.userLiked.bind(Object(b.a)(a)),a.deleteSubmission=a.deleteSubmission.bind(Object(b.a)(a)),a.expandComment=a.expandComment.bind(Object(b.a)(a)),a}return Object(E.a)(t,e),Object(d.a)(t,[{key:"componentDidUpdate",value:function(e,t){e.id!==this.props.id&&(this.setState({amountOfLikes:0,userLiked:!1}),this.getLikeAmount(),this.userLiked())}},{key:"componentDidMount",value:function(){this.getLikeAmount(),this.userLiked(),this.getAvatar()}},{key:"getTime",value:function(){var e=this.props.time,t=new Date-e,a=t/1e3/60/60;return a>=24?Math.round(a/24)+" days ago":a<1?a<.016?"now":Math.round(t/1e3/60)+" minutes ago":Math.round(a)+" hours ago"}},{key:"userLiked",value:function(){for(var e=this.props.likes,t=0;t<e.length;t++)e[t].uid===this.props.uid?this.setState({userLiked:!0}):this.setState({userLiked:!1})}},{key:"renderHeart",value:function(){return this.state.userLiked?r.a.createElement(O.a,{type:"heart",theme:"filled",key:"heart",style:{color:"#ff7a45",fontSize:"20px"}}):r.a.createElement(O.a,{type:"heart",key:"heart",style:{color:"rgba(255,255,255,0.3)",fontSize:"20px"}})}},{key:"getLikeAmount",value:function(){this.setState({amountOfLikes:this.props.likeCount})}},{key:"like",value:function(){this.props.uid?!1===this.state.userLiked?(this.setState({userLiked:!0,amountOfLikes:this.state.amountOfLikes+1}),Object(A.getFirestore)().collection("stories").doc(this.props.postId).collection("submissions").doc(this.props.id).update({likes:qe.firestore.FieldValue.arrayUnion({uid:this.props.uid}),likeCount:qe.firestore.FieldValue.increment(1)})):(this.setState({userLiked:!1,amountOfLikes:this.state.amountOfLikes-1}),Object(A.getFirestore)().collection("stories").doc(this.props.postId).collection("submissions").doc(this.props.id).update({likes:qe.firestore.FieldValue.arrayRemove({uid:this.props.uid}),likeCount:qe.firestore.FieldValue.increment(-1)})):x.a.error("Please login to like submissions")}},{key:"getAvatar",value:function(){var e=this;Object(A.getFirestore)().collection("users").doc(this.props.author).get().then((function(t){t.exists?void 0!==t.data().photoURL?e.setState({photoURL:t.data().photoURL}):e.setState({photoURL:null}):x.a.error("No such document!")})).catch((function(e){x.a.error("Error getting document:",e)}))}},{key:"deleteSubmission",value:function(){Object(A.getFirestore)().collection("stories").doc(this.props.postId).collection("submissions").doc(this.props.id).delete().then((function(){x.a.success("Your submission has been deleted.")})).catch((function(e){x.a.error(e)}))}},{key:"isOwnSubmission",value:function(){if(this.props.auth.displayName===this.props.author)return r.a.createElement(w.a,{title:"Are you sure you want to delete your submission?",onConfirm:this.deleteSubmission,okText:"Yes",cancelText:"No"},"delete")}},{key:"expandComment",value:function(){this.setState({expanded:!this.state.expanded})}},{key:"expandStyle",value:function(){return this.state.expanded?{height:"auto"}:{maxHeight:"6.3em",overflow:"hidden"}}},{key:"render",value:function(){var e=[this.isOwnSubmission()];return r.a.createElement("div",{className:"comment-hover"},r.a.createElement(Ke.a,{author:r.a.createElement(c.c,{to:{pathname:"/user/"+this.props.author}},this.props.author),actions:e,avatar:r.a.createElement("div",{style:{height:"100%"}},r.a.createElement(h.a,{style:{display:"flex",flexDirection:"column"}},r.a.createElement(L.a,{title:this.props.author},r.a.createElement(c.c,{to:{pathname:"/user/"+this.props.author}},null!==this.state.photoURL?r.a.createElement(C.a,{src:this.state.photoURL}):r.a.createElement(C.a,{style:{background:"#111717",color:"#171F22"},icon:"user"})))),r.a.createElement(h.a,{style:{display:"flex",flexDirection:"column",alignItems:"center",marginTop:"14px"}},r.a.createElement("div",{onClick:this.like,style:{display:"flex",flexDirection:"column",justifyContent:"center"}},r.a.createElement(L.a,{title:"Like"},this.renderHeart())),r.a.createElement("div",null,r.a.createElement("small",{style:{color:"rgba(255,255,255,0.6)"}},this.state.amountOfLikes)))),content:r.a.createElement("div",null,r.a.createElement("div",{onClick:this.expandComment,style:this.expandStyle(),className:"comment-text-hover"},r.a.createElement("p",null,this.props.comment)),r.a.createElement("div",null,this.state.expanded?null:r.a.createElement("p",null,"..."))),datetime:this.getTime()}))}}]),t}(n.Component),Ze=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(y.a)(this,Object(f.a)(t).call(this,e))).state={loaded:!1,submissions:[],sortOrder:"desc"},a.handleSort=a.handleSort.bind(Object(b.a)(a)),a.handleSortOrder=a.handleSortOrder.bind(Object(b.a)(a)),a}return Object(E.a)(t,e),Object(d.a)(t,[{key:"componentDidUpdate",value:function(e,t){if(this.state.loaded!==this.props.loaded||e.submissions!==this.props.submissions)return this.setState({loaded:!0,submissions:this.props.submissions}),this.props.getSubmissions(this.props.auth.uid,this.props.submissions)}},{key:"handleSort",value:function(e){return this.props.updateSort(e)}},{key:"handleSortOrder",value:function(){return"desc"===this.props.sortOrder?this.props.updateSortOrder("asc"):this.props.updateSortOrder("desc")}},{key:"renderSortArrow",value:function(){return"desc"===this.props.sortOrder?r.a.createElement(O.a,{type:"down"}):r.a.createElement(O.a,{type:"up"})}},{key:"getComments",value:function(){var e=this;return this.state.loaded&&this.state.submissions.length>0?r.a.createElement(Re.a,{className:"comment-list",header:this.getCommentSort(),itemLayout:"horizontal",dataSource:this.getSubmissions(),renderItem:function(t){return r.a.createElement("li",null,r.a.createElement(Ye,{id:t.id,postId:t.postId,auth:e.props.auth,uid:e.props.auth.uid,author:t.author,comment:t.content,likes:t.likes,likeCount:t.likeCount,time:t.time}))}}):r.a.createElement(Re.a,{className:"comment-list",header:this.getCommentSort(),itemLayout:"horizontal",dataSource:[],locale:{emptyText:r.a.createElement("p",null,"No Submissions")}})}},{key:"getCommentSort",value:function(){var e=v.a.Option;return r.a.createElement("div",{style:{marginBottom:"24px",marginTop:"24px"}},r.a.createElement(v.a,{defaultValue:"time",style:{width:80},onChange:this.handleSort,showArrow:!1},r.a.createElement(e,{value:"time"},"New"),r.a.createElement(e,{value:"likeCount"},"Top")),r.a.createElement(k.a,{style:{marginLeft:"5px",marginRight:"24px"},onClick:this.handleSortOrder},this.renderSortArrow()),r.a.createElement("small",null,r.a.createElement(R.a,null,r.a.createElement(O.a,{type:"hourglass"})," "+this.props.timeLeft),r.a.createElement(R.a,null,this.state.submissions.length+" submissions")))}},{key:"getSubmissions",value:function(){for(var e=[],t=0;t<this.state.submissions.length;t++)e.push({postId:this.state.submissions[t].postId,uid:this.props.auth.uid,id:this.state.submissions[t].id,author:this.state.submissions[t].author,content:this.state.submissions[t].content,likes:this.state.submissions[t].likes,likeCount:this.state.submissions[t].likeCount,time:this.state.submissions[t].time.toDate()});return e}},{key:"render",value:function(){return r.a.createElement("div",{id:"comments"},this.getComments())}}]),t}(n.Component),Je=Object(B.d)(Object(P.b)((function(e,t){return{submissions:e.firestore.ordered.submissions,auth:e.firebase.auth,loaded:!0}})),Object(W.firestoreConnect)((function(e){return[{collection:"stories",doc:e.id,subcollections:[{collection:"submissions"}],where:["chapter","==",e.chapter],orderBy:[e.sort,e.sortOrder],storeAs:"submissions"}]})))(Ze),Qe=N.a.TextArea,_e=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(y.a)(this,Object(f.a)(t).call(this,e))).handleChange=function(e){if("content"===e.target.id){var t=e.target.value.toString();a.setState({remainingCharacters:1e4-t.length})}a.setState(Object(V.a)({},e.target.id,e.target.value))},a.handleSubmit=function(e){e.preventDefault(),a.state.content.length<10?x.a.error("Chapter submission is too short"):a.state.remainingCharacters>0?(a.props.closePanel(),a.props.submitChapter(a.state)):x.a.error("Chapter submission is too long")},a.state={content:"",remainingCharacters:1e4},a}return Object(E.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.setState({postId:this.props.id,chapter:this.props.chapter})}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(z.a,{onSubmit:this.handleSubmit},r.a.createElement(z.a.Item,null,r.a.createElement(Qe,{id:"content",className:"submit-chapter-input",onChange:this.handleChange,autosize:{minRows:3,maxRows:15}})),r.a.createElement("span",{style:this.state.remainingCharacters<0?{color:"#fa541c",opacity:.5}:{opacity:.5}},r.a.createElement("small",null,this.state.remainingCharacters," characters left")),r.a.createElement("br",null),r.a.createElement(k.a,{type:"primary",id:"submit-chapter-button",htmlType:"submit"},"Submit")))}}]),t}(n.Component),$e=Object(P.b)((function(e){return{auth:e.firebase.auth}}),(function(e){return{submitChapter:function(t){return e(function(e){return function(t,a,n){var r=n.getFirebase;(0,n.getFirestore)().collection("stories").doc(e.postId).collection("submissions").doc().set(X({},e,{likes:[],likeCount:0,author:r().auth().currentUser.displayName,time:new Date})),x.a.success("Your chapter has been submitted!").then((function(){t({type:"SUBMIT_CHAPTER",submission:e})})).catch((function(e){t({type:"SUBMIT_CHAPTER_ERROR",err:e})}))}}(t))}}}))(_e),et=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(y.a)(this,Object(f.a)(t).call(this,e))).state={amountOfLikes:0},a}return Object(E.a)(t,e),Object(d.a)(t,[{key:"componentDidUpdate",value:function(e,t){e.id!==this.props.id&&(this.setState({amountOfLikes:0,userLiked:!1}),this.getLikeAmount())}},{key:"componentDidMount",value:function(){this.getLikeAmount(),this.getAvatar()}},{key:"getLikeAmount",value:function(){this.setState({amountOfLikes:this.props.likeCount})}},{key:"getAvatar",value:function(){var e=this;Object(A.getFirestore)().collection("users").doc(this.props.author).get().then((function(t){t.exists?void 0!==t.data().photoURL?e.setState({photoURL:t.data().photoURL}):e.setState({photoURL:null}):x.a.error("No such document!")})).catch((function(e){x.a.error("Error getting document:",e)}))}},{key:"getTime",value:function(){var e=this.props.time,t=new Date-e,a=t/1e3/60/60;return a>=24?Math.round(a/24)+" days ago":a<1?a<.016?"now":Math.round(t/1e3/60)+" minutes ago":Math.round(a)+" hours ago"}},{key:"render",value:function(){return r.a.createElement("div",{className:"comment-hover",style:{marginTop:"24px",paddingRight:"24px"}},r.a.createElement(Ke.a,{author:r.a.createElement(c.c,{to:{pathname:"/user/"+this.props.author}},this.props.author),avatar:r.a.createElement("div",{style:{height:"100%"}},r.a.createElement(h.a,{style:{display:"flex",flexDirection:"column"}},r.a.createElement(L.a,{title:this.props.author},null!==this.state.photoURL?r.a.createElement(C.a,{src:this.state.photoURL}):r.a.createElement(C.a,{style:{background:"#111717",color:"#171F22"},icon:"user"})))),content:r.a.createElement("div",null,r.a.createElement("div",{className:"comment-text-hover"},r.a.createElement("p",null,this.props.comment))),datetime:this.getTime()}))}}]),t}(n.Component),tt=a(95),at=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(y.a)(this,Object(f.a)(t).call(this,e))).onChange=function(e){a.setState({selectedChapter:e.target.value})},a.state={panelOpen:!1,chapter:1,sort:"time",sortOrder:"desc",uid:"",likes:[],amountOfLikes:0,userLiked:!1,submissions:[],submissionsLoaded:!1,userSubmitted:!0,selectedChapter:0,timeLeft:0},a.updateCommentSort=a.updateCommentSort.bind(Object(b.a)(a)),a.updateCommentSortOrder=a.updateCommentSortOrder.bind(Object(b.a)(a)),a.getSubmissions=a.getSubmissions.bind(Object(b.a)(a)),a.openSubmitPanel=a.openSubmitPanel.bind(Object(b.a)(a)),a.closeSubmitPanel=a.closeSubmitPanel.bind(Object(b.a)(a)),a.onChange=a.onChange.bind(Object(b.a)(a)),a.like=a.like.bind(Object(b.a)(a)),a.userLiked=a.userLiked.bind(Object(b.a)(a)),a.hasUserSubmitted=a.hasUserSubmitted.bind(Object(b.a)(a)),a.timeLeft=a.timeLeft.bind(Object(b.a)(a)),a.next=a.next.bind(Object(b.a)(a)),a.prev=a.prev.bind(Object(b.a)(a)),a}return Object(E.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e,t=this.props.currentChapter;e=this.props.complete?0:t-1,this.setState({amountOfLikes:this.props.likes.length,currentChapter:t,selectedChapter:e}),this.userLiked()}},{key:"componentDidUpdate",value:function(e,t){var a=this;t.submissions!==this.state.submissions&&this.setState({submissionsLoaded:!0},(function(){a.hasUserSubmitted(),a.timeLeft()}))}},{key:"getComments",value:function(){var e=this.props.selectedChapters,t=this.state.selectedChapter,a=this.state.currentChapter;return a?t+1<a||this.props.complete?r.a.createElement("div",{style:{backgroundColor:"#0E1314"}},r.a.createElement(et,{id:e[t].id,postId:e[t].postId,uid:this.props.auth.uid,author:e[t].author,comment:e[t].content,likes:e[t].likes,likeCount:e[t].likeCount,auth:this.props.auth,time:this.props.createdAt.toDate()})):r.a.createElement(Je,{id:this.props.id,uid:this.state.uid,chapter:this.state.selectedChapter+1,sort:this.state.sort,sortOrder:this.state.sortOrder,updateSort:this.updateCommentSort,updateSortOrder:this.updateCommentSortOrder,submissions:this.state.submissions,getSubmissions:this.getSubmissions,timeLeft:this.state.timeLeft}):r.a.createElement("p",null,"Loadin")}},{key:"getEnabledRadios",value:function(){for(var e=this.props.currentChapter,t=[],a=this.state.timeLeft,n=1;n<=e;n++)n===e&&!1===this.props.complete?t.push(r.a.createElement(L.a,{title:a+" until chapter "+n+" is chosen"},r.a.createElement(I.a.Button,{style:{marginRight:"14px"},value:n-1,description:a},r.a.createElement(O.a,{style:{marginRight:"7px"},type:"hourglass"}),"Chapter "+n))):t.push(r.a.createElement(I.a.Button,{style:{marginRight:"14px"},value:n-1},r.a.createElement(O.a,{style:{marginRight:"7px"},type:"check"}),"Chapter "+n));return t}},{key:"getDisabledRadios",value:function(){for(var e=this.props.currentChapter,t=this.props.numberOfChapters,a=[],n=e+1;n<=t;n++)a.push(r.a.createElement(I.a.Button,{value:n-1,style:{opacity:.3,marginRight:"14px"},disabled:!0},"Chapter ",n));return a}},{key:"renderChapterRadios",value:function(){return r.a.createElement("div",null,r.a.createElement(I.a.Group,{defaultValue:this.props.currentChapter-1,buttonStyle:"solid",onChange:this.onChange},this.getEnabledRadios(),this.getDisabledRadios()))}},{key:"updateCommentSort",value:function(e){this.setState({sort:e,sortOrder:"desc"})}},{key:"updateCommentSortOrder",value:function(e){this.setState({sortOrder:e})}},{key:"getSubmissions",value:function(e,t){this.setState({uid:e,submissions:t})}},{key:"getTopSubmission",value:function(){var e=this.state.submissions,t=[];if(e.sort((function(e,t){return t.likeCount-e.likeCount})),e.length>0&&this.state.submissionsLoaded){if(e.length>1)for(var a=0;a<e.length-1&&e[a].likeCount===e[a+1].likeCount;a++)t.push(e[a]),t.push(e[a+1]);t.length>0?(t.sort((function(e,t){return t.time.toDate()-e.time.toDate()})),this.endSubmissionProcess(t[0])):this.endSubmissionProcess(e[0])}else Object(A.getFirestore)().collection("stories").doc(this.props.id).delete()}},{key:"openSubmitPanel",value:function(){this.setState({panelOpen:!this.state.panelOpen})}},{key:"closeSubmitPanel",value:function(){this.setState({panelOpen:!1})}},{key:"hasUserSubmitted",value:function(){var e=this.state.submissions;if(this.props.auth.isEmpty)return null;if(e.length>0)for(var t=0;t<e.length;t++){if(e[t].author===this.props.auth.displayName&&e[t].chapter===this.props.currentChapter){this.setState({userSubmitted:!0,panelOpen:!1});break}this.setState({userSubmitted:!1,panelOpen:!0})}else this.setState({userSubmitted:!1,panelOpen:!0})}},{key:"renderSubmitHeader",value:function(){if(this.state.panelOpen)return r.a.createElement($e,{id:this.props.id,chapter:this.props.currentChapter,closePanel:this.closeSubmitPanel})}},{key:"like",value:function(){!1===this.props.auth.isEmpty?!1===this.state.userLiked?(this.setState({userLiked:!0,amountOfLikes:this.state.amountOfLikes+1}),Object(A.getFirestore)().collection("stories").doc(this.props.id).update({likes:tt.firestore.FieldValue.arrayUnion(this.props.auth.displayName),likeCount:tt.firestore.FieldValue.increment(1)})):(this.setState({userLiked:!1,amountOfLikes:this.state.amountOfLikes-1}),Object(A.getFirestore)().collection("stories").doc(this.props.id).update({likes:tt.firestore.FieldValue.arrayRemove(this.props.auth.displayName),likeCount:tt.firestore.FieldValue.increment(-1)})):x.a.warning("Please login or sign up to like prompts")}},{key:"userLiked",value:function(){for(var e=this.props.likes,t=0;t<e.length;t++){if(e[t]===this.props.auth.displayName){this.setState({userLiked:!0});break}this.setState({userLiked:!1})}}},{key:"renderHeart",value:function(){return this.state.userLiked?r.a.createElement(O.a,{type:"heart",theme:"filled",size:"large",key:"heart",style:{color:"#ff7a45"}}):r.a.createElement(O.a,{type:"heart",key:"heart",style:{color:"rgba(255, 255, 255, 0.4)"}})}},{key:"timeLeft",value:function(){var e,t=this.props.currentChapter,a=this.props.createdAt.toDate(),n=new Date,r=new Date(a.getTime()+1728e5),i=new Date(r.getTime()+1728e5),s=new Date(i.getTime()+1728e5),o=new Date(s.getTime()+1728e5);switch(t){case 1:e=(r-n)/6e4;break;case 2:e=(i-n)/6e4;break;case 3:e=(s-n)/6e4;break;case 4:e=(o-n)/6e4}e<0?!1===this.props.complete?this.getTopSubmission():this.setState({timeLeft:null}):e>60?this.setState({timeLeft:Math.round(e/60)+"hrs left"}):e>0&&this.setState({timeLeft:Math.round(e)+"min left"})}},{key:"endSubmissionProcess",value:function(e){var t=new Date;this.props.currentChapter!==this.props.numberOfChapters?(Object(A.getFirestore)().collection("stories").doc(this.props.id).update({currentChapter:this.props.currentChapter+1,selectedChapters:tt.firestore.FieldValue.arrayUnion(e)}),Object(A.getFirestore)().collection("notifications").doc().set({title:this.props.title,notification:"is now on chapter "+(this.props.currentChapter+1),type:"chapter",id:this.props.id,time:t.toString(),date:t})):(Object(A.getFirestore)().collection("stories").doc(this.props.id).update({complete:!0,selectedChapters:tt.firestore.FieldValue.arrayUnion(e)}),Object(A.getFirestore)().collection("notifications").doc().set({title:this.props.title,notification:"has been completed",type:"complete",id:this.props.id,time:t.toString(),date:t}))}},{key:"next",value:function(){this.setState({selectedChapter:this.state.selectedChapter+1})}},{key:"prev",value:function(){this.setState({selectedChapter:this.state.selectedChapter-1})}},{key:"renderButtons",value:function(){var e=this.state.selectedChapter+1;return e<this.props.numberOfChapters?e>1?r.a.createElement("div",null,r.a.createElement(k.a,{style:{marginRight:"7px"},onClick:this.prev},"Prev"),r.a.createElement(k.a,{onClick:this.next},"Next")):r.a.createElement("div",null,r.a.createElement(k.a,{onClick:this.next},"Next")):r.a.createElement("div",null,r.a.createElement(k.a,{onClick:this.prev},"Prev"))}},{key:"renderModalButtons",value:function(){return r.a.createElement("div",{className:"modal-buttons"},r.a.createElement(k.a,{type:"link",onClick:this.like},r.a.createElement("span",{style:{display:"flex",alignItems:"center"}},this.renderHeart(),r.a.createElement("span",{id:"likes"},this.state.amountOfLikes))),r.a.createElement(L.a,{title:this.props.author},r.a.createElement(k.a,{type:"link"},r.a.createElement(c.c,{to:{pathname:"/user/"+this.props.author}},r.a.createElement("span",{style:{display:"flex",alignItems:"center"}},r.a.createElement(O.a,{type:"user",key:"user"}))))),r.a.createElement(M,{title:this.props.title,type:"story",id:this.props.id,component:"modal"}),r.a.createElement($.CopyToClipboard,{text:window.location.href,onCopy:function(){return x.a.success("Link copied to clipboard")}},r.a.createElement(k.a,{type:"link"},r.a.createElement("span",{style:{display:"flex",alignItems:"center"}},r.a.createElement(O.a,{type:"share-alt"})))))}},{key:"renderSubmitButton",value:function(){return this.props.auth.isEmpty?r.a.createElement(k.a,{onClick:function(){x.a.error("Please login to submit chapters")},style:{paddingBottom:"30px",paddingRight:"10px",paddingLeft:"10px",paddingTop:"10px",marginRight:"14px"},type:"primary"},r.a.createElement(O.a,{type:"plus"})," Submit Chapter ",this.props.currentChapter):r.a.createElement(k.a,{onClick:this.openSubmitPanel,style:{paddingBottom:"30px",paddingRight:"10px",paddingLeft:"10px",paddingTop:"10px",marginRight:"28px"},type:this.state.panelOpen?"dashed":"primary",disabled:this.state.userSubmitted},this.state.userSubmitted?r.a.createElement(O.a,{type:"check"}):this.state.panelOpen?r.a.createElement(O.a,{type:"minus"}):r.a.createElement(O.a,{type:"plus"}),this.state.userSubmitted?"Chapter Submitted":"Submit Chapter "+this.props.currentChapter)}},{key:"render",value:function(){return r.a.createElement("div",{style:{padding:"48px",backgroundColor:"#0E1314"}},r.a.createElement(h.a,{type:"flex",align:"middle"},r.a.createElement(p.a,null,r.a.createElement(h.a,{type:"flex",align:"middle"},r.a.createElement(p.a,null,r.a.createElement("h1",{style:{margin:0}},this.props.title),r.a.createElement("p",{style:{margin:0,opacity:.5}},"created by",r.a.createElement(c.c,{to:{pathname:"/user/"+this.props.author}},r.a.createElement("b",{style:{color:"white",opacity:.9}}," ",this.props.author))))))),r.a.createElement(se.a,null),r.a.createElement(h.a,{style:{marginTop:"24px"},type:"flex",align:"middle"},r.a.createElement(p.a,null,r.a.createElement("p",null,this.props.prompt))),r.a.createElement(h.a,{style:{marginTop:"24px"},type:"flex",align:"middle"},r.a.createElement(p.a,null,this.renderSubmitButton()),r.a.createElement(p.a,null,this.renderModalButtons())),r.a.createElement(h.a,null,this.renderSubmitHeader()),r.a.createElement(h.a,{style:{marginTop:"48px"}},r.a.createElement(p.a,null,this.renderChapterRadios())),r.a.createElement(h.a,{style:{marginTop:"24px"}},this.getComments()),r.a.createElement(h.a,null,this.props.complete?r.a.createElement("div",{style:{backgroundColor:"#111717",padding:"24px"}},this.renderButtons()):null))}}]),t}(n.Component),nt=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(y.a)(this,Object(f.a)(t).call(this,e))).state={visible:!0,loaded:!1,error:!1},a.handleCancel=a.handleCancel.bind(Object(b.a)(a)),a.showModal=a.showModal.bind(Object(b.a)(a)),a.goBack=a.goBack.bind(Object(b.a)(a)),a}return Object(E.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=window.location.pathname.split("/").pop();Object(A.getFirestore)().collection("stories").doc(t).get().then((function(t){void 0!==t.data()?e.setState({data:t.data()}):e.setState({error:!0})})).catch((function(t){e.setState({error:!0})}))}},{key:"componentDidUpdate",value:function(e,t){t.data!==this.state.data&&this.setState({loaded:!0})}},{key:"goBack",value:function(){this.props.history.goBack()}},{key:"showModal",value:function(){this.setState({visible:!0})}},{key:"handleCancel",value:function(){this.props.history.goBack()}},{key:"render",value:function(){if(this.state.loaded){var e=this.state.data,t=window.location.pathname.split("/").pop();return r.a.createElement(U.a,{visible:this.state.visible,onCancel:this.handleCancel,footer:null,style:{top:0,padding:0},className:"story-modal"},r.a.createElement(at,{id:t,auth:this.props.auth,title:e.title,author:e.author,authorPic:e.authorPic,genre:e.genre,currentChapter:e.currentChapter,chapters:e.chapters,prompt:e.prompt,createdAt:e.createdAt,chapter2:e.chapter2,chapter3:e.chapter3,chapter4:e.chapter4,likes:e.likes,numberOfChapters:e.numberOfChapters,selectedChapters:e.selectedChapters,complete:e.complete}))}return r.a.createElement(U.a,{visible:!0,onCancel:this.handleCancel,footer:null,style:{display:"flex",textAlign:"center"}},this.state.error?r.a.createElement("div",{style:{padding:"48px"}},r.a.createElement("h1",null,"Story not found."),r.a.createElement("small",null,"* Stories that receive no submissions are automatically deleted.")):null)}}]),t}(n.Component),rt=Object(P.b)((function(e,t){return{auth:e.firebase.auth}}))(nt),it=function(){return r.a.createElement(c.a,null,r.a.createElement(o.a,null,r.a.createElement("div",null,r.a.createElement(Xe,null),r.a.createElement(l.a,null),r.a.createElement(u.b,{exact:!0,path:"/",render:function(){return r.a.createElement(u.a,{to:"/prompts/all"})}}),r.a.createElement(u.b,{path:"/prompts/all",component:je}),r.a.createElement(u.b,{path:"/prompts/comedy",component:je}),r.a.createElement(u.b,{path:"/prompts/horror",component:je}),r.a.createElement(u.b,{path:"/prompts/fantasy",component:je}),r.a.createElement(u.b,{path:"/prompts/scifi",component:je}),r.a.createElement(u.b,{path:"/prompts/other",component:je}),r.a.createElement(u.b,{path:"/stories/all",component:je}),r.a.createElement(u.b,{path:"/stories/complete",component:je}),r.a.createElement(u.b,{path:"/stories/comedy",component:je}),r.a.createElement(u.b,{path:"/stories/horror",component:je}),r.a.createElement(u.b,{path:"/stories/fantasy",component:je}),r.a.createElement(u.b,{path:"/stories/scifi",component:je}),r.a.createElement(u.b,{path:"/stories/other",component:je}),r.a.createElement(u.b,{path:"/user/:id",component:je}),r.a.createElement(u.b,{path:"/story/:id",component:rt}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function st(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function ot(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?st(a,!0).forEach((function(t){Object(V.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):st(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var lt={authError:null},ct=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:lt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN_ERROR":return ot({},e,{authError:"Login failed"});case"LOGIN_SUCCESS":return ot({},e,{authError:null});case"SIGNOUT_SUCCESS":return e;case"SIGNUP_SUCCESS":return ot({},e,{authError:null});case"SIGNUP_ERROR":return ot({},e,{authError:t.err.message});case"NAME_TAKEN":return ot({},e,{authError:"Name is already taken"});default:return e}},ut={posts:[{id:1,title:"Greek God Revenge",content:"Youre an ancient Greek man coming home from 4 months of war to find your wife 3 months pregnant. Now youve embarked on a solemn quest: to punch Zeus in the face."},{id:2,title:"Where Is My Super Suit",content:'The Suit is powerfull. A mech for some, body armor for others, always unique to each person who wore it. Those who wear it, hear the words "not original user, booting basic mode" As a joke, your sergeant gives you The Suit and the first thing you hear is: "User detected: Welcome back, Commander"'},{id:3,title:"School Reunion",content:"The nightmare has come true; youve woken up back in sixth grade with your memories and knowledge of everything that happened since then intact. You start staring at your classmates around you, aware of how they end up. Your teacher asks you whats wrong as you start weeping."},{id:4,title:"Seth The Killer",content:"The nightmare has come true; youve woken up back in sixth grade with your memories and knowledge of everything that happened since then intact. You start staring at your classmates around you, aware of how they end up. Your teacher asks you whats wrong as you start weeping."},{id:5,title:"School Reunion",content:"The nightmare has come true; youve woken up back in sixth grade with your memories and knowledge of everything that happened since then intact. You start staring at your classmates around you, aware of how they end up. Your teacher asks you whats wrong as you start weeping."}]},ht=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ut,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CREATE_POST":case"CREATE_POST_ERR":default:return e}},pt=Object(B.c)({auth:ct,post:ht,firestore:A.firestoreReducer,firebase:W.firebaseReducer}),mt=a(383),dt=a(158),yt=(a(711),a(712),dt.initializeApp({apiKey:"AIzaSyC-1qE_pSDh3kKMmLI3fA4iErj4qGuZrgw",authDomain:"writingrelay.firebaseapp.com",databaseURL:"https://writingrelay.firebaseio.com",projectId:"writingrelay",storageBucket:"writingrelay.appspot.com",messagingSenderId:"549963888326",appId:"1:549963888326:web:65281ab754acef09",measurementId:"G-6WJBXYLBZY"}));dt.analytics(yt),dt.firestore().settings({timestampsInSnapshots:!0});var ft=dt,bt=Object(B.e)(pt,Object(B.d)(Object(B.a)(mt.a.withExtraArgument({getFirestore:A.getFirestore,getFirebase:W.getFirebase})),Object(A.reduxFirestore)(ft),Object(W.reactReduxFirebase)(ft,{attachAuthIsReady:!0})));bt.firebaseAuthIsReady.then((function(){s.a.render(r.a.createElement(P.a,{store:bt},r.a.createElement(it,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}))}},[[387,1,2]]]);
//# sourceMappingURL=main.e4105055.chunk.js.map